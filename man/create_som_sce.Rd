% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/02_sce_batch_correct.R
\name{create_som_sce}
\alias{create_som_sce}
\title{Create Self-Organizing Map or Other Clusters for Batch Correction}
\usage{
create_som_sce(
  object,
  assay = "normalized",
  markers = NULL,
  seed = 473,
  rlen = 10,
  mode = c("online", "batch", "pbatch"),
  cluster_method = c("kohonen", "flowsom", "fusesom", "leiden"),
  resolution = 0.8,
  distf = c("euclidean", "sumofsquares", "cosine", "manhattan", "chebyshev"),
  xdim = 6,
  ydim = 6,
  nClus = NULL
)
}
\arguments{
\item{markers}{A character vector specifying the markers (features) to use for
clustering. If NULL, all features in the specified assay are used.}

\item{seed}{Integer, random seed for reproducibility.}

\item{rlen}{Integer, the number of iterations for SOM training.}

\item{mode}{Character, SOM training mode ("online", "batch", "pbatch") for "kohonen".}

\item{cluster_method}{Clustering method: "kohonen", "flowsom", "louvain", or "leiden".}

\item{resolution}{Numeric, resolution parameter for Louvain/Leiden community
detection (\code{igraph}). Higher values lead to more clusters. Ignored
if \code{cluster_method} is not "louvain" or "leiden".}

\item{distf}{Character, distance function for SOM ("euclidean", "sumofsquares",
"cosine", "manhattan", "chebyshev"). Note: "sumofsquares" is equivalent to
Euclidean for Kohonen, FlowSOM uses numerical codes (see documentation).
Cosine is often good for high-dimensional data.}

\item{xdim}{Integer, the x-dimension of the SOM grid (for "kohonen" and "flowsom").}

\item{ydim}{Integer, the y-dimension of the SOM grid (for "kohonen" and "flowsom").}

\item{nClus}{Integer, the target number of clusters for FlowSOM metaclusteirng.
If NULL (default for FlowSOM), the grid node assignments are used directly.}

\item{sce}{A SingleCellExperiment object.}

\item{assay_name}{Character string specifying the assay containing the
data to use for clustering (e.g., "normdata" from \code{normalize_sce}).}

\item{batch_col}{Character string specifying the column name in \code{colData(sce)}
that contains batch information. Defaults to "batch". Needed for FlowSOM distance calc.}

\item{BPPARAM}{A \code{BiocParallelParam} object for parallel PCA computation.
Defaults to \code{BiocParallel::SerialParam()}.}

\item{labels_colname}{Character string for the column name in \code{colData(sce)}
where the resulting cluster labels will be stored. Defaults to "Labels".}
}
\value{
A SingleCellExperiment object with cluster labels added to \code{colData}.
}
\description{
This function clusters cells using various methods (SOM via Kohonen or FlowSOM,
graph-based Louvain/Leiden) on a specified assay (typically normalized data).
The resulting clusters are used to segregate cells for more targeted batch
correction, making the correction less affected by compositional differences
between batches.
}
